<UserControl xmlns="https://github.com/avaloniaui"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:vm="using:GameInfoTools.UI.ViewModels"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
			 x:Class="GameInfoTools.UI.Views.TextExtractorView"
			 x:DataType="vm:TextExtractorViewModel">

	<Design.DataContext>
		<vm:TextExtractorViewModel/>
	</Design.DataContext>

	<Grid RowDefinitions="Auto,*,Auto">
		<!-- Toolbar -->
		<StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="8" Margin="16,16,16,8">
			<Button Content="Load TBL..." Command="{Binding LoadTableCommand}" CommandParameter="{Binding $parent[Window]}" ToolTip.Tip="Load text table file"/>
			<Button Content="Default ASCII" Command="{Binding LoadDefaultTableCommand}" ToolTip.Tip="Load default ASCII table"/>
			<Separator/>
			<Button Content="Extract" Command="{Binding ExtractStringsCommand}" ToolTip.Tip="Extract strings from ROM"/>
			<Button Content="Search" Command="{Binding SearchCommand}" ToolTip.Tip="Search for pattern"/>
			<Separator/>
			<Button Content="Export..." Command="{Binding ExportCommand}" CommandParameter="{Binding $parent[Window]}" ToolTip.Tip="Export extracted strings"/>
		</StackPanel>

		<!-- Main Content -->
		<Grid Grid.Row="1" ColumnDefinitions="*,300" Margin="16,8">
			<!-- Extracted Strings List -->
			<Border Grid.Column="0" Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
					CornerRadius="4" Padding="8" Margin="0,0,8,0">
				<DockPanel>
					<TextBlock DockPanel.Dock="Top" Text="Extracted Strings" FontWeight="SemiBold" Margin="0,0,0,8"/>
					<DataGrid ItemsSource="{Binding ExtractedStrings}" AutoGenerateColumns="False"
							  IsReadOnly="True" GridLinesVisibility="Horizontal">
						<DataGrid.Columns>
							<DataGridTextColumn Header="Offset" Binding="{Binding Offset}" Width="80"/>
							<DataGridTextColumn Header="Length" Binding="{Binding Length}" Width="60"/>
							<DataGridTextColumn Header="Text" Binding="{Binding Text}" Width="*"/>
							<DataGridTextColumn Header="Confidence" Binding="{Binding Confidence, StringFormat=P0}" Width="80"/>
						</DataGrid.Columns>
					</DataGrid>
				</DockPanel>
			</Border>

			<!-- Settings Panel -->
			<Border Grid.Column="1" Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
					CornerRadius="4" Padding="16">
				<StackPanel Spacing="16">
					<TextBlock Text="Settings" FontWeight="SemiBold" FontSize="16"/>

					<StackPanel Spacing="4">
						<TextBlock Text="Table File:"/>
						<TextBlock Text="{Binding TableInfo}" Opacity="0.7" TextWrapping="Wrap"/>
					</StackPanel>

					<StackPanel Spacing="4">
						<TextBlock Text="Min String Length:"/>
						<NumericUpDown Value="{Binding MinStringLength}" Minimum="1" Maximum="100"/>
					</StackPanel>

					<StackPanel Spacing="4">
						<TextBlock Text="Min Confidence:"/>
						<Slider Value="{Binding MinConfidence}" Minimum="0" Maximum="1"/>
						<TextBlock Text="{Binding MinConfidence, StringFormat=P0}" Opacity="0.7"/>
					</StackPanel>

					<Separator/>

					<StackPanel Spacing="4">
						<TextBlock Text="Search Pattern:"/>
						<TextBox Text="{Binding SearchPattern}" Watermark="Enter text to search..."/>
					</StackPanel>

					<Separator/>

					<TextBlock Text="Statistics" FontWeight="SemiBold"/>
					<TextBlock Text="{Binding StatusText}" Opacity="0.7" TextWrapping="Wrap"/>
				</StackPanel>
			</Border>
		</Grid>

		<!-- Status Bar -->
		<Border Grid.Row="2" Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" Padding="16,8">
			<TextBlock Text="{Binding StatusText}"/>
		</Border>
	</Grid>
</UserControl>
