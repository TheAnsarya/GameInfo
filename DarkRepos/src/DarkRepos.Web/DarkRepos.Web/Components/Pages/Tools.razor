@page "/tools"
@using DarkRepos.Core.Models

<PageTitle>Tools - Dark Repos</PageTitle>

<HeadContent>
	<meta name="description" content="ROM hacking and retro game research tools for analysis, extraction, and modification." />
</HeadContent>

<div class="container">
	<nav class="breadcrumbs" aria-label="Breadcrumb">
		<span class="breadcrumb-item"><a href="/">Home</a></span>
		<span class="breadcrumb-separator" aria-hidden="true">/</span>
		<span class="breadcrumb-item" aria-current="page">Tools</span>
	</nav>

	<header class="page-header">
		<h1 class="page-title">Tools</h1>
		<p class="page-description">
			ROM hacking and retro game research tools for analysis, asset extraction, and modification.
		</p>
	</header>

	<div class="filter-bar" role="group" aria-label="Filter tools by category">
		<span style="color: var(--color-text-secondary); font-size: var(--font-size-sm);">Category:</span>
		<div class="filter-group">
			<button class="filter-chip @(SelectedCategory == null ? "active" : "")"
					@onclick="() => FilterByCategory(null)">
				All
			</button>
			<button class="filter-chip @(SelectedCategory == ToolCategory.Analysis ? "active" : "")"
					@onclick="() => FilterByCategory(ToolCategory.Analysis)">
				Analysis
			</button>
			<button class="filter-chip @(SelectedCategory == ToolCategory.Graphics ? "active" : "")"
					@onclick="() => FilterByCategory(ToolCategory.Graphics)">
				Graphics
			</button>
			<button class="filter-chip @(SelectedCategory == ToolCategory.Text ? "active" : "")"
					@onclick="() => FilterByCategory(ToolCategory.Text)">
				Text
			</button>
			<button class="filter-chip @(SelectedCategory == ToolCategory.Disassembly ? "active" : "")"
					@onclick="() => FilterByCategory(ToolCategory.Disassembly)">
				Disassembly
			</button>
		</div>
	</div>

	@if (FilteredTools.Any())
	{
		<div class="grid grid-cols-1 md:grid-cols-2" role="list">
			@foreach (var tool in FilteredTools)
			{
				<article class="tool-card" role="listitem">
					<div class="tool-card-icon">
						@GetToolIcon(tool.Category)
					</div>
					<div class="tool-card-content">
						<h2 class="tool-card-title">
							<a href="/tools/@tool.Slug">@tool.Name</a>
						</h2>
						<p class="tool-card-description">@tool.Description</p>
						<div class="tool-card-tags">
							<span class="badge" style="background: var(--color-bg-tertiary);">
								@tool.Category
							</span>
							@if (!string.IsNullOrEmpty(tool.Language))
							{
								<span class="badge" style="background: var(--color-bg-tertiary);">
									@tool.Language
								</span>
							}
							@if (!string.IsNullOrEmpty(tool.Version))
							{
								<span class="badge" style="background: var(--color-bg-tertiary);">
									v@tool.Version
								</span>
							}
						</div>
					</div>
				</article>
			}
		</div>

		<p role="status" class="sr-only">Showing @FilteredTools.Count() tools</p>
	}
	else
	{
		<div class="empty-state">
			<div class="empty-state-icon">ðŸ”§</div>
			<h2 class="empty-state-title">No tools found</h2>
			<p class="empty-state-description">
				No tools match the selected category. Try a different filter.
			</p>
			<button class="btn btn-secondary" @onclick="() => FilterByCategory(null)">
				Show all tools
			</button>
		</div>
	}
</div>

@code {
	private ToolCategory? SelectedCategory { get; set; }

	private List<Tool> AllTools { get; set; } = new();

	private IEnumerable<Tool> FilteredTools => SelectedCategory == null
		? AllTools
		: AllTools.Where(t => t.Category == SelectedCategory);

	protected override void OnInitialized()
	{
		AllTools = new List<Tool>
		{
			new Tool
			{
				Slug = "rom-analyzer",
				Name = "ROM Analyzer",
				Description = "Analyze ROM files to identify data structures, code sections, graphics, and other assets. Generates reports and suggestions for documentation.",
				Category = ToolCategory.Analysis,
				Language = "Python",
				Version = "1.0.0",
				RepositoryUrl = "https://github.com/TheAnsarya/GameInfo",
				SupportedGames = ["NES", "SNES", "GB", "GBA"]
			},
			new Tool
			{
				Slug = "asset-extractor",
				Name = "Asset Extractor",
				Description = "Extract graphics, text, audio, and other assets from ROM files. Supports multiple formats and platforms.",
				Category = ToolCategory.Graphics,
				Language = "Python",
				Version = "1.0.0",
				RepositoryUrl = "https://github.com/TheAnsarya/GameInfo"
			},
			new Tool
			{
				Slug = "text-dumper",
				Name = "Text Dumper",
				Description = "Extract and dump text strings from ROMs using table files. Supports pointer tables and various encoding schemes.",
				Category = ToolCategory.Text,
				Language = "Python",
				Version = "1.0.0",
				RepositoryUrl = "https://github.com/TheAnsarya/GameInfo"
			},
			new Tool
			{
				Slug = "tile-viewer",
				Name = "Tile Viewer",
				Description = "View and export graphics tiles from ROM files. Supports various color depths and palette formats.",
				Category = ToolCategory.Graphics,
				Language = "C#",
				Version = "0.9.0",
				RepositoryUrl = "https://github.com/TheAnsarya/GameInfo"
			},
			new Tool
			{
				Slug = "disasm-tools",
				Name = "Disassembly Tools",
				Description = "Tools for creating and managing disassemblies. Includes label management, cross-referencing, and documentation generation.",
				Category = ToolCategory.Disassembly,
				Language = "Python",
				Version = "1.0.0",
				RepositoryUrl = "https://github.com/TheAnsarya/GameInfo"
			},
			new Tool
			{
				Slug = "wiki-generator",
				Name = "Wiki Generator",
				Description = "Generate MediaWiki-formatted pages from structured data. Creates ROM maps, RAM maps, and data structure documentation.",
				Category = ToolCategory.General,
				Language = "Python",
				Version = "1.0.0",
				RepositoryUrl = "https://github.com/TheAnsarya/GameInfo"
			}
		};
	}

	private void FilterByCategory(ToolCategory? category)
	{
		SelectedCategory = category;
		StateHasChanged();
	}

	private RenderFragment GetToolIcon(ToolCategory category) => category switch
	{
		ToolCategory.Analysis => @<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
			<path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
		</svg>,
		ToolCategory.Graphics => @<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
			<path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
		</svg>,
		ToolCategory.Text => @<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
			<path d="M2.5 4v3h5v12h3V7h5V4h-13zm19 5h-9v3h3v7h3v-7h3V9z"/>
		</svg>,
		ToolCategory.Disassembly => @<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
			<path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>
		</svg>,
		_ => @<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
			<path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
		</svg>
	};
}
