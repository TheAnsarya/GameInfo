<div class="toast-container" aria-live="polite" aria-atomic="true">
	@foreach (var toast in _toasts) {
		<Toast
			Message="@toast.Message"
			Title="@toast.Title"
			Type="@toast.Type"
			Dismissible="@toast.Dismissible"
			Duration="@toast.Duration"
			AutoClose="@toast.AutoClose"
			OnClose="() => Remove(toast.Id)" />
	}
</div>

@code {
	private readonly List<ToastItem> _toasts = new();

	public void Show(string message, Toast.ToastType type = Toast.ToastType.Info, string? title = null, int duration = 5000) {
		var toast = new ToastItem {
			Id = Guid.NewGuid(),
			Message = message,
			Title = title,
			Type = type,
			Duration = duration,
			Dismissible = true,
			AutoClose = true
		};
		_toasts.Add(toast);
		StateHasChanged();
	}

	public void ShowInfo(string message, string? title = null) =>
		Show(message, Toast.ToastType.Info, title);

	public void ShowSuccess(string message, string? title = null) =>
		Show(message, Toast.ToastType.Success, title);

	public void ShowWarning(string message, string? title = null) =>
		Show(message, Toast.ToastType.Warning, title);

	public void ShowError(string message, string? title = null) =>
		Show(message, Toast.ToastType.Error, title);

	private void Remove(Guid id) {
		var toast = _toasts.FirstOrDefault(t => t.Id == id);
		if (toast != null) {
			_toasts.Remove(toast);
			StateHasChanged();
		}
	}

	public void Clear() {
		_toasts.Clear();
		StateHasChanged();
	}

	private class ToastItem {
		public Guid Id { get; init; }
		public string Message { get; init; } = string.Empty;
		public string? Title { get; init; }
		public Toast.ToastType Type { get; init; }
		public int Duration { get; init; }
		public bool Dismissible { get; init; }
		public bool AutoClose { get; init; }
	}
}
