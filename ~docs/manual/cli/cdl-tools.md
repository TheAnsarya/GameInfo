# CDL Tools - Manual Testing Guide

> **Parent Guide:** [CLI Tools](README.md)  
> **GitHub Issue:** [#33](https://github.com/TheAnsarya/GameInfo/issues/33)  
> **Related Issues:** [#4](https://github.com/TheAnsarya/GameInfo/issues/4) (Visualization), [#5](https://github.com/TheAnsarya/GameInfo/issues/5) (Format Conversion)

## ğŸ“‹ Overview

CDL (Code/Data Log) tools analyze emulator coverage files:
- **stats** - Show coverage statistics
- **banks** - Bank-level breakdown
- **heatmap** - ASCII visualization
- **export** - Export to CSV
- **regions** - Show contiguous regions
- **merge** - Combine multiple CDL files
- **diff** - Compare two CDL files
- **export-mlb** - Export as Mesen labels
- **export-sym** - Export as SYM labels
- **convert** - Convert between formats

## ğŸ¯ Prerequisites

- [ ] GameInfo CLI built
- [ ] Sample CDL files (FCEUX, Mesen, or bsnes format)
- [ ] Understanding of CDL concepts (code vs data logging)

### Getting CDL Files

CDL files are generated by emulators during gameplay:

**FCEUX:**
1. Debug â†’ Code/Data Logger â†’ Start
2. Play game
3. Debug â†’ Code/Data Logger â†’ Save

**Mesen:**
1. Debug â†’ Code/Data Logger â†’ Start
2. Play game
3. File â†’ Save CDL file

**bsnes:**
1. Tools â†’ Tracer â†’ Enable CDL
2. Play game
3. Save CDL file

## âœ… Test Checklist

### `git analysis cdl stats` - Coverage Statistics
- [ ] TEST-CDL-001: Show stats for FCEUX CDL
- [ ] TEST-CDL-002: Show stats for Mesen CDL
- [ ] TEST-CDL-003: Show stats with format option

### `git analysis cdl banks` - Bank Statistics
- [ ] TEST-CDL-004: Show bank breakdown
- [ ] TEST-CDL-005: Custom bank size

### `git analysis cdl heatmap` - ASCII Heatmap
- [ ] TEST-CDL-006: Generate default heatmap
- [ ] TEST-CDL-007: Custom width heatmap

### `git analysis cdl export` - Export to CSV
- [ ] TEST-CDL-008: Export coverage to CSV

### `git analysis cdl regions` - Contiguous Regions
- [ ] TEST-CDL-009: Show regions
- [ ] TEST-CDL-010: Filter by minimum size

### `git analysis cdl merge` - Merge CDL Files
- [ ] TEST-CDL-011: Merge two CDL files
- [ ] TEST-CDL-012: Merge multiple CDL files

### `git analysis cdl diff` - Compare CDL Files
- [ ] TEST-CDL-013: Compare two CDL files

### `git analysis cdl export-mlb` - Export as MLB Labels
- [ ] TEST-CDL-014: Export to MLB format

### `git analysis cdl export-sym` - Export as SYM Labels
- [ ] TEST-CDL-015: Export to SYM format

### `git analysis cdl convert` - Format Conversion
- [ ] TEST-CDL-016: Convert FCEUX to Mesen
- [ ] TEST-CDL-017: Convert Mesen to FCEUX
- [ ] TEST-CDL-018: Convert bsnes to FCEUX

---

## ğŸ§ª Detailed Test Instructions

### TEST-CDL-001: Show Stats for FCEUX CDL

**Purpose:** Verify CDL statistics display.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl stats "game.cdl"
   ```

**Expected Result:**
```
CDL Statistics
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
File:           game.cdl
Format:         FCEUX
Size:           XXXXX bytes

Coverage Summary:
  Total bytes:    XXXXX
  Code logged:    XXXXX (XX.X%)
  Data logged:    XXXXX (XX.X%)
  Both:           XXXXX (XX.X%)
  Unknown:        XXXXX (XX.X%)

PRG Coverage:
  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  42.3%

Flag Breakdown:
  Code only:      XXXXX bytes
  Data only:      XXXXX bytes
  Code+Data:      XXXXX bytes
  PCM Audio:      XXXXX bytes
  Indirect Code:  XXXXX bytes
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**Verification:**
- [ ] File info displayed
- [ ] Format detected correctly
- [ ] Percentages calculated correctly
- [ ] Visual progress bar shown

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-002: Show Stats for Mesen CDL

**Purpose:** Verify Mesen .mcdl format support.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl stats "game.mcdl"
   ```

**Expected Result:**
- Format detected as Mesen
- Statistics displayed correctly
- No errors about format

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-003: Show Stats with Format Option

**Purpose:** Verify explicit format specification.

**Steps:**
1. Run with --format:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl stats "game.cdl" --format fceux
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl stats "game.cdl" --format mesen
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl stats "game.cdl" --format bsnes
   ```

**Expected Result:**
- Format used as specified
- Error if format doesn't match file

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-004: Show Bank Breakdown

**Purpose:** Verify bank-level statistics.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl banks "game.cdl"
   ```

**Expected Result:**
```
CDL Bank Statistics
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
File:       game.cdl
Bank size:  16384 bytes ($4000)

Bank #  | Offset     | Code    | Data    | Total   | Coverage
--------|------------|---------|---------|---------|----------
  0     | $00000     |   4521  |   2341  |   6862  | 41.9%
  1     | $04000     |   8234  |   1256  |   9490  | 57.9%
  2     | $08000     |   2100  |   6543  |   8643  | 52.8%
  ...

Most logged bank:  #1 (57.9%)
Least logged bank: #0 (41.9%)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**Verification:**
- [ ] Each bank shown
- [ ] Offsets correct
- [ ] Coverage calculated per bank

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-005: Custom Bank Size

**Purpose:** Verify custom bank size option.

**Steps:**
1. Run with custom size:
   ```powershell
   # 8KB banks
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl banks "game.cdl" --bank-size 8192
   
   # 32KB banks
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl banks "game.cdl" --bank-size 32768
   ```

**Expected Result:**
- Banks calculated using specified size
- Number of banks changes accordingly

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-006: Generate Default Heatmap

**Purpose:** Verify ASCII heatmap generation.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl heatmap "game.cdl"
   ```

**Expected Result:**
```
CDL Heatmap (64 cells wide)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Legend: C=Code  D=Data  #=Both  â–‘=Unknown

Bank 0 ($00000-$03FFF):
CCCCDDDD####CCCCâ–‘â–‘â–‘â–‘DDDDCCCC####â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘CCCCDDDDâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
DDDDCCCCâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆCCCCDDDDâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘CCCCDDDDCCCCâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
...

Bank 1 ($04000-$07FFF):
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆCCCCDDDDCCCCâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆCCCCDDDDâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
...
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Verification:**
- [ ] Heatmap displayed
- [ ] Legend shown
- [ ] Different characters for code/data/both/unknown

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-007: Custom Width Heatmap

**Purpose:** Verify width option.

**Steps:**
1. Run with different widths:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl heatmap "game.cdl" --width 32
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl heatmap "game.cdl" --width 128
   ```

**Expected Result:**
- Heatmap width matches specified value
- More detail with larger width

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-008: Export Coverage to CSV

**Purpose:** Verify CSV export functionality.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl export "game.cdl" --output "coverage.csv"
   ```
2. Open coverage.csv

**Expected Result:**
```csv
Address,Flags,IsCode,IsData,Description
$00000,0x01,true,false,Code
$00001,0x01,true,false,Code
$00002,0x02,false,true,Data
...
```

**Verification:**
- [ ] CSV file created
- [ ] Correct columns
- [ ] All addresses included
- [ ] Opens in Excel/LibreOffice

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-009: Show Regions

**Purpose:** Verify contiguous region detection.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl regions "game.cdl"
   ```

**Expected Result:**
```
CDL Contiguous Regions
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Code Regions:
  $00000-$001FF  (512 bytes)
  $00400-$00BFF  (2048 bytes)
  $01000-$01FFF  (4096 bytes)
  ...

Data Regions:
  $00200-$003FF  (512 bytes)
  $00C00-$00FFF  (1024 bytes)
  ...

Largest code region:  $01000-$01FFF (4096 bytes)
Largest data region:  $08000-$08FFF (4096 bytes)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**Verification:**
- [ ] Code regions listed
- [ ] Data regions listed
- [ ] Ranges accurate
- [ ] Sizes calculated correctly

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-010: Filter by Minimum Size

**Purpose:** Verify minimum size filter.

**Steps:**
1. Run with minimum size:
   ```powershell
   # Only show regions >= 256 bytes
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl regions "game.cdl" --min-size 256
   
   # Only show regions >= 1KB
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl regions "game.cdl" --min-size 1024
   ```

**Expected Result:**
- Small regions filtered out
- Only regions >= min-size shown

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-011: Merge Two CDL Files

**Purpose:** Verify CDL merge functionality.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl merge "session1.cdl" "session2.cdl" --output "merged.cdl"
   ```
2. Verify merged.cdl contains coverage from both

**Expected Result:**
```
CDL Merge
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input files:
  session1.cdl  (42.3% coverage)
  session2.cdl  (38.7% coverage)

Merging... Done!

Output:       merged.cdl
New coverage: 67.2% (combined unique coverage)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**Verification:**
- [ ] Merged file created
- [ ] Coverage is union of inputs
- [ ] File size matches inputs

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-012: Merge Multiple CDL Files

**Purpose:** Verify merging more than 2 files.

**Steps:**
1. Run with multiple files:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl merge "s1.cdl" "s2.cdl" "s3.cdl" "s4.cdl" --output "all.cdl"
   ```

**Expected Result:**
- All files merged
- Statistics for each input shown
- Final combined coverage displayed

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-013: Compare Two CDL Files

**Purpose:** Verify CDL diff functionality.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl diff "before.cdl" "after.cdl"
   ```

**Expected Result:**
```
CDL Comparison
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
File 1: before.cdl
File 2: after.cdl

Coverage Comparison:
                   before.cdl    after.cdl    Diff
  Code logged:     4521          5234         +713
  Data logged:     2341          2567         +226
  Total logged:    6862          7801         +939

New in after.cdl:
  Code regions: 12 new (1534 bytes)
  Data regions: 8 new (892 bytes)

Only in before.cdl:
  (none - after is superset)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**Verification:**
- [ ] Both files compared
- [ ] Differences identified
- [ ] New coverage shown
- [ ] Statistics accurate

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-014: Export to MLB Format

**Purpose:** Verify Mesen label export.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl export-mlb "game.cdl" --output "labels.mlb" --prefix "cdl"
   ```
2. Check labels.mlb format

**Expected Result:**
```
# Mesen Label File
# Generated from CDL: game.cdl
P:0000:cdl_code_00000
P:0001:cdl_code_00001
...
P:0200:cdl_data_00200
...
```

**Verification:**
- [ ] MLB file created
- [ ] Correct MLB format
- [ ] Labels have specified prefix
- [ ] Can load in Mesen

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-015: Export to SYM Format

**Purpose:** Verify SYM label export.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl export-sym "game.cdl" --output "labels.sym" --prefix "cdl"
   ```
2. Check labels.sym format

**Expected Result:**
```
; Symbol file generated from CDL
[labels]
00:0000 cdl_code_00000
00:0001 cdl_code_00001
...
```

**Verification:**
- [ ] SYM file created
- [ ] Correct SYM format
- [ ] Bank:address format used
- [ ] Can load in compatible tools

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-016: Convert FCEUX to Mesen

**Purpose:** Verify FCEUX â†’ Mesen conversion.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl convert "game.cdl" --format fceux --target mesen --output "game.mcdl"
   ```
2. Load game.mcdl in Mesen

**Expected Result:**
- File created in Mesen format
- Coverage data preserved
- Can load in Mesen debugger

**Verification:**
- [ ] File created
- [ ] Coverage matches original
- [ ] Loads in Mesen

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-017: Convert Mesen to FCEUX

**Purpose:** Verify Mesen â†’ FCEUX conversion.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl convert "game.mcdl" --format mesen --target fceux --output "game.cdl"
   ```

**Expected Result:**
- File created in FCEUX format
- Coverage data preserved

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

### TEST-CDL-018: Convert bsnes to FCEUX

**Purpose:** Verify bsnes â†’ FCEUX conversion.

**Steps:**
1. Run:
   ```powershell
   dotnet run --project src/GameInfoTools.Cli -- analysis cdl convert "game-bsnes.cdl" --format bsnes --target fceux --output "game.cdl"
   ```

**Expected Result:**
- File created in FCEUX format
- Flag mapping applied correctly (0x80â†’Code, 0x40â†’Data)

**Verification:**
- [ ] Conversion completed
- [ ] Flags mapped correctly
- [ ] Coverage percentages preserved

**Result:** â˜ Pass â˜ Fail â˜ Blocked

---

## ğŸ“Š Test Results Summary

| Test ID | Description | Status | Date | Tester |
|---------|-------------|--------|------|--------|
| TEST-CDL-001 | FCEUX stats | â˜ | | |
| TEST-CDL-002 | Mesen stats | â˜ | | |
| TEST-CDL-003 | Format option | â˜ | | |
| TEST-CDL-004 | Bank breakdown | â˜ | | |
| TEST-CDL-005 | Custom bank size | â˜ | | |
| TEST-CDL-006 | Default heatmap | â˜ | | |
| TEST-CDL-007 | Custom width | â˜ | | |
| TEST-CDL-008 | CSV export | â˜ | | |
| TEST-CDL-009 | Show regions | â˜ | | |
| TEST-CDL-010 | Min size filter | â˜ | | |
| TEST-CDL-011 | Merge two | â˜ | | |
| TEST-CDL-012 | Merge multiple | â˜ | | |
| TEST-CDL-013 | Diff files | â˜ | | |
| TEST-CDL-014 | Export MLB | â˜ | | |
| TEST-CDL-015 | Export SYM | â˜ | | |
| TEST-CDL-016 | FCEUXâ†’Mesen | â˜ | | |
| TEST-CDL-017 | Mesenâ†’FCEUX | â˜ | | |
| TEST-CDL-018 | bsnesâ†’FCEUX | â˜ | | |

**Total:** 0/18 tests completed

---

**Next:** [Data Tools Testing](data-tools.md)
