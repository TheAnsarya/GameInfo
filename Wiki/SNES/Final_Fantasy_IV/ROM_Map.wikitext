{{Back|Final Fantasy IV (SNES)}}
{{Rommap}}
{{Cleanup}}

= Final Fantasy IV (SNES) - ROM Map =

This page documents the ROM structure for '''Final Fantasy IV''' (SNES), also known as '''Final Fantasy II''' in the US release.

== Overview ==

Final Fantasy IV uses a '''HiROM''' memory mapping with a 2 MB (16 Mbit) ROM size.

* US Release: Final Fantasy II (1991)
* Japanese Release: Final Fantasy IV (1991)
* Japanese Easy Type: Final Fantasy IV Easy Type (1991)

==Bank Structure==

The game uses HiROM mapping, so ROM banks start at $c0.

{| class="wikitable sortable"
! Bank !! Offset !! Size !! Description
|-
| $c0 || $00000 || $8000 || Main program code, reset vectors
|-
| $c1 || $08000 || $8000 || Core engine routines
|-
| $c2 || $10000 || $8000 || Battle engine - ATB system
|-
| $c3 || $18000 || $8000 || Menu and interface code
|-
| $c4 || $20000 || $8000 || Event/cutscene engine
|-
| $c5 || $28000 || $8000 || Map engine and tile handling
|-
| $c6 || $30000 || $8000 || NPC/actor management
|-
| $c7 || $38000 || $8000 || Sound driver interface
|-
| $c8-$cf || $40000 || $40000 || Event scripts and dialogue
|-
| $d0-$d7 || $80000 || $40000 || Map data and tilesets
|-
| $d8-$db || $c0000 || $20000 || Character/monster graphics
|-
| $dc-$df || $e0000 || $20000 || Battle backgrounds and effects
|-
| $e0-$e7 || $100000 || $40000 || Music and sound data (SPC700)
|-
| $e8-$ef || $140000 || $40000 || Additional graphics and animations
|}

==Header Information==

{| class="wikitable"
! Offset !! Size !! Description
|-
| $ffc0 || 21 bytes || Internal ROM name
|-
| $ffd5 || 1 byte || Map mode (HiROM = $31)
|-
| $ffd6 || 1 byte || ROM type
|-
| $ffd7 || 1 byte || ROM size ($0b = 2 MB)
|-
| $ffd8 || 1 byte || SRAM size ($03 = 8 KB)
|-
| $ffd9 || 1 byte || Region code
|-
| $ffda || 1 byte || Developer ID (Square = $c3)
|-
| $ffdb || 1 byte || Version number
|-
| $ffdc-$ffdf || 4 bytes || Checksum complement and checksum
|-
| $ffe0-$ffef || 16 bytes || Co-processor vectors (unused)
|-
| $fff0-$ffff || 16 bytes || Native mode vectors
|}

==Character Data==

===Character Stats Table===

Location: $c10000-$c103ff (approximate)

{| class="wikitable"
! Offset !! Size !! Description
|-
| $00 || 1 byte || Character ID
|-
| $01 || 1 byte || Base level
|-
| $02 || 2 bytes || Base HP
|-
| $04 || 2 bytes || Base MP
|-
| $06 || 1 byte || Base Strength
|-
| $07 || 1 byte || Base Agility
|-
| $08 || 1 byte || Base Vitality
|-
| $09 || 1 byte || Base Intellect
|-
| $0a || 1 byte || Base Spirit
|-
| $0b || 1 byte || Starting equipment weapon
|-
| $0c || 1 byte || Starting equipment armor
|-
| $0d || 1 byte || Starting equipment helmet
|-
| $0e || 1 byte || Starting equipment gloves
|}

===Character ID Values===

{| class="wikitable"
! ID !! Character !! Class
|-
| $00 || Cecil (Dark Knight) || Dark Knight
|-
| $01 || Cecil (Paladin) || Paladin
|-
| $02 || Kain || Dragoon
|-
| $03 || Rosa || White Mage
|-
| $04 || Rydia (Child) || Summoner
|-
| $05 || Rydia (Adult) || Summoner
|-
| $06 || Edward || Bard
|-
| $07 || Yang || Monk
|-
| $08 || Palom || Black Mage
|-
| $09 || Porom || White Mage
|-
| $0a || Tellah || Sage
|-
| $0b || Cid || Engineer
|-
| $0c || Edge || Ninja
|-
| $0d || FuSoYa || Lunarian
|}

==Monster Data==

===Monster Stats Table===

Location: $c20000-$c27fff (approximate)

Each monster entry is $20 bytes:

{| class="wikitable"
! Offset !! Size !! Description
|-
| $00 || 2 bytes || HP
|-
| $02 || 2 bytes || MP
|-
| $04 || 2 bytes || Experience reward
|-
| $06 || 2 bytes || Gil reward
|-
| $08 || 1 byte || Level
|-
| $09 || 1 byte || Attack power
|-
| $0a || 1 byte || Defense
|-
| $0b || 1 byte || Magic defense
|-
| $0c || 1 byte || Agility
|-
| $0d || 1 byte || Evasion
|-
| $0e || 1 byte || Magic evasion
|-
| $0f || 1 byte || Hit rate
|-
| $10 || 2 bytes || Elemental weaknesses (bitfield)
|-
| $12 || 2 bytes || Elemental resistances (bitfield)
|-
| $14 || 2 bytes || Status immunities (bitfield)
|-
| $16 || 1 byte || Monster type flags
|-
| $17 || 1 byte || AI script index
|-
| $18 || 1 byte || Drop item 1
|-
| $19 || 1 byte || Drop item 2
|-
| $1a || 1 byte || Drop rate
|-
| $1b-$1f || 5 bytes || Reserved
|}

===Elemental Bits===

{| class="wikitable"
! Bit !! Element
|-
| 0 || Fire
|-
| 1 || Ice
|-
| 2 || Thunder
|-
| 3 || Dark/Shadow
|-
| 4 || Holy
|-
| 5 || Wind
|-
| 6 || Earth
|-
| 7 || Water
|}

==Item Data==

===Item Table===

Location: $c30000-$c33fff (approximate)

Each item entry is $10 bytes:

{| class="wikitable"
! Offset !! Size !! Description
|-
| $00 || 1 byte || Item type
|-
| $01 || 1 byte || Item subtype/category
|-
| $02 || 1 byte || Attack/power value
|-
| $03 || 1 byte || Defense value
|-
| $04 || 1 byte || Evade modifier
|-
| $05 || 1 byte || Magic evade modifier
|-
| $06 || 1 byte || Stat bonuses (packed)
|-
| $07 || 1 byte || Elemental properties
|-
| $08 || 1 byte || Status effects
|-
| $09 || 1 byte || Equip flags (who can equip)
|-
| $0a || 2 bytes || Price
|-
| $0c || 1 byte || Special properties
|-
| $0d-$0f || 3 bytes || Reserved/flags
|}

===Item Type Values===

{| class="wikitable"
! Value !! Type
|-
| $00 || Consumable
|-
| $01 || Weapon
|-
| $02 || Armor
|-
| $03 || Helmet
|-
| $04 || Gloves
|-
| $05 || Shield
|-
| $06 || Accessory
|-
| $07 || Key item
|}

==Magic/Ability Data==

===White Magic Table===

{| class="wikitable"
! ID !! Spell !! MP Cost !! Effect
|-
| $00 || Cure || 3 || Restore HP
|-
| $01 || Cura || 9 || Restore more HP
|-
| $02 || Curaga || 18 || Restore significant HP
|-
| $03 || Curaja || 40 || Full HP restore
|-
| $04 || Esuna || 10 || Cure status ailments
|-
| $05 || Raise || 25 || Revive with low HP
|-
| $06 || Arise || 50 || Revive with full HP
|-
| $07 || Protect || 7 || Raise defense
|-
| $08 || Shell || 7 || Raise magic defense
|-
| $09 || Haste || 12 || Increase ATB speed
|-
| $0a || Slow || 9 || Reduce enemy ATB
|-
| $0b || Berserk || 5 || Auto-attack mode
|-
| $0c || Dispel || 12 || Remove buffs
|-
| $0d || Mini || 6 || Shrink target
|-
| $0e || Sight || 2 || View map
|-
| $0f || Float || 8 || Avoid ground attacks
|-
| $10 || Hold || 5 || Paralyze enemy
|-
| $11 || Confuse || 10 || Cause confusion
|-
| $12 || Teleport || 10 || Exit dungeon
|-
| $13 || Holy || 46 || Holy damage
|}

===Black Magic Table===

{| class="wikitable"
! ID !! Spell !! MP Cost !! Effect
|-
| $00 || Fire || 5 || Fire damage
|-
| $01 || Fira || 15 || Medium fire damage
|-
| $02 || Firaga || 30 || Heavy fire damage
|-
| $03 || Blizzard || 5 || Ice damage
|-
| $04 || Blizzara || 15 || Medium ice damage
|-
| $05 || Blizzaga || 30 || Heavy ice damage
|-
| $06 || Thunder || 5 || Thunder damage
|-
| $07 || Thundara || 15 || Medium thunder damage
|-
| $08 || Thundaga || 30 || Heavy thunder damage
|-
| $09 || Bio || 20 || Poison damage
|-
| $0a || Drain || 18 || Absorb HP
|-
| $0b || Osmose || 0 || Absorb MP
|-
| $0c || Quake || 30 || Earth damage to all
|-
| $0d || Tornado || 25 || Reduce to critical HP
|-
| $0e || Death || 35 || Instant death
|-
| $0f || Flare || 50 || Non-elemental damage
|-
| $10 || Meteor || 99 || Heavy non-elemental
|-
| $11 || Sleep || 8 || Put to sleep
|-
| $12 || Pig || 1 || Transform to pig
|-
| $13 || Toad || 7 || Transform to toad
|-
| $14 || Break || 15 || Petrify
|-
| $15 || Stop || 15 || Freeze in time
|-
| $16 || Warp || 4 || Return to previous floor
|}

===Summon Magic Table===

{| class="wikitable"
! ID !! Summon !! MP Cost !! Effect
|-
| $00 || Chocobo || 7 || Chocobo Kick
|-
| $01 || Shiva || 30 || Diamond Dust (ice)
|-
| $02 || Ifrit || 30 || Hellfire (fire)
|-
| $03 || Ramuh || 30 || Judgment Bolt (thunder)
|-
| $04 || Titan || 40 || Gaia's Wrath (earth)
|-
| $05 || Dragon || 20 || Mist Breath
|-
| $06 || Sylph || 25 || Whispering Wind (drain)
|-
| $07 || Odin || 45 || Zantetsuken (death)
|-
| $08 || Leviathan || 50 || Tsunami (water)
|-
| $09 || Asura || 50 || Random heal/buff
|-
| $0a || Bahamut || 60 || Mega Flare
|}

==Event System==

===Event Script Pointers===

Location: $c40000-$c47fff (approximate)

Event scripts control cutscenes, NPC dialogue, and story progression.

{| class="wikitable"
! Offset !! Description
|-
| $c40000 || Event pointer table start
|-
| $c40800 || Event script data start
|-
| $c48000 || Cutscene scripts
|}

===Event Commands===

{| class="wikitable"
! Command !! Parameters !! Description
|-
| $00 || - || End event
|-
| $01 || [msg_id] || Display message
|-
| $02 || [char_id] || Add party member
|-
| $03 || [char_id] || Remove party member
|-
| $04 || [item_id] || Give item
|-
| $05 || [item_id] || Take item
|-
| $06 || [gil_lo] [gil_hi] || Give gil
|-
| $07 || [map_id] [x] [y] || Teleport
|-
| $08 || [flag_id] || Set flag
|-
| $09 || [flag_id] || Clear flag
|-
| $0a || [flag_id] [offset] || Branch if flag set
|-
| $0b || [battle_id] || Start battle
|-
| $0c || [npc_id] [path] || Move NPC
|-
| $0d || [time] || Wait
|-
| $0e || [music_id] || Play music
|-
| $0f || - || Fade out
|}

==Map Data==

===Map Header Structure===

Location: $d00000-$d7ffff (approximate)

{| class="wikitable"
! Offset !! Size !! Description
|-
| $00 || 2 bytes || Tileset pointer (low)
|-
| $02 || 1 byte || Tileset pointer (bank)
|-
| $03 || 2 bytes || Map data pointer (low)
|-
| $05 || 1 byte || Map data pointer (bank)
|-
| $06 || 1 byte || Map width
|-
| $07 || 1 byte || Map height
|-
| $08 || 1 byte || Encounter rate
|-
| $09 || 1 byte || Music ID
|-
| $0a || 1 byte || Map flags
|-
| $0b || 2 bytes || NPC table pointer
|-
| $0d || 2 bytes || Exit table pointer
|-
| $0f || 1 byte || Palette ID
|}

===Map ID Table===

{| class="wikitable"
! ID !! Location
|-
| $00 || Baron Castle
|-
| $01 || Baron Town
|-
| $02 || Mist Cave
|-
| $03 || Mist Village
|-
| $04 || Kaipo
|-
| $05 || Underground Waterway
|-
| $06 || Damcyan Castle
|-
| $07 || Mt. Hobs
|-
| $08 || Fabul Castle
|-
| $09 || Mysidia
|-
| $0a || Mt. Ordeals
|-
| $0b || Baron Castle (Throne)
|-
| $0c || Troia Castle
|-
| $0d || Magnetic Cave
|-
| $0e || Tower of Zot
|-
| $0f || Dwarven Castle
|-
| $10 || Tower of Babil
|-
| $11 || Eblan Cave
|-
| $12 || Sealed Cave
|-
| $13 || Land of Summons
|-
| $14 || Giant of Babil
|-
| $15 || Lunar Path
|-
| $16 || Lunar Subterrane
|}

==Battle System==

===ATB (Active Time Battle) System===

The battle engine is located primarily in bank $c2.

{| class="wikitable"
! Address !! Description
|-
| $c20000 || Battle initialization
|-
| $c20400 || ATB timer management
|-
| $c20800 || Action execution
|-
| $c20c00 || Damage calculation
|-
| $c21000 || Magic/ability effects
|-
| $c21400 || Status effect processing
|-
| $c21800 || Enemy AI routines
|-
| $c21c00 || Victory/defeat handling
|}

===Battle Formation Data===

{| class="wikitable"
! Offset !! Size !! Description
|-
| $00 || 1 byte || Background ID
|-
| $01 || 1 byte || Music ID
|-
| $02 || 1 byte || Number of enemies
|-
| $03-$0a || 8 bytes || Enemy IDs (up to 8)
|-
| $0b-$12 || 8 bytes || Enemy positions
|-
| $13 || 1 byte || Battle flags
|-
| $14 || 1 byte || Boss flag
|}

==Graphics Data==

===Character Sprite Data===

Location: $d80000-$dbffff (approximate)

{| class="wikitable"
! Address Range !! Description
|-
| $d80000-$d87fff || Party member sprites (map)
|-
| $d88000-$d8ffff || Party member sprites (battle)
|-
| $d90000-$d9ffff || NPC sprites
|-
| $da0000-$daffff || Enemy sprites (1)
|-
| $db0000-$dbffff || Enemy sprites (2)
|}

===Tileset Data===

Location: $dc0000-$dfffff (approximate)

{| class="wikitable"
! Address Range !! Description
|-
| $dc0000-$dc7fff || Overworld tiles
|-
| $dc8000-$dcffff || Town/castle tiles
|-
| $dd0000-$dd7fff || Dungeon tiles
|-
| $dd8000-$dfffff || Battle backgrounds
|}

==Audio Data==

===Music Track Pointers===

Location: $e00000-$e7ffff (approximate)

{| class="wikitable"
! ID !! Track Name
|-
| $00 || Prelude
|-
| $01 || Red Wings
|-
| $02 || Kingdom of Baron
|-
| $03 || Love's Theme
|-
| $04 || Prologue
|-
| $05 || Battle Theme
|-
| $06 || Victory Fanfare
|-
| $07 || Chocobo Theme
|-
| $08 || Into the Darkness
|-
| $09 || Fight 1 (Boss)
|-
| $0a || Suspense
|-
| $0b || Cry in Sorrow
|-
| $0c || Rydia
|-
| $0d || Castle Damcyan
|-
| $0e || Edward's Harp
|-
| $0f || Mt. Ordeals
|-
| $10 || Fabul
|-
| $11 || Battle 2 (Four Fiends)
|-
| $12 || The Airship
|-
| $13 || Troian Beauty
|-
| $14 || Mystic Mysidia
|-
| $15 || Long Way to Go
|-
| $16 || Palom and Porom
|-
| $17 || Golbez, Clad in Dark
|-
| $18 || Hey Cid!
|-
| $19 || Tower of Babil
|-
| $1a || Somewhere in the World
|-
| $1b || Land of Dwarves
|-
| $1c || Giott, King of the Dwarves
|-
| $1d || Dancing Calcobrena
|-
| $1e || Tower of Zot
|-
| $1f || The Dreadful Fight
|-
| $20 || The Lunarians
|-
| $21 || Within the Giant
|-
| $22 || Final Battle
|-
| $23 || Epilogue
|-
| $24 || Theme of Love (Ending)
|}

===Sound Effect Pointers===

{| class="wikitable"
! ID !! Description
|-
| $00-$0f || Menu sounds
|-
| $10-$2f || Battle sounds
|-
| $30-$4f || Magic effects
|-
| $50-$6f || Monster sounds
|-
| $70-$8f || Environmental sounds
|}

==Notes==

* All addresses are approximate and based on the US release
* The Japanese version has slight differences in data placement
* The Easy Type version has modified battle data and spell MP costs
* See [[Final Fantasy IV (SNES):TBL|TBL]] for text encoding

[[Category:Final Fantasy IV (SNES)|ROM map]]
